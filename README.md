# RBE 502 Robot Control Fall 2018  
## by Jakub Kaminski, Calvin He, and Mostafa Atalla
## Final Project
## Instructor: Dr. Jie Fu

## Project: Trajectory Planning of KUKA YouBot Under Various Payloads


### Instructions to run project implementation:
### Clone repository:
    git clone https://github.com/wpi-youbot/wpi-youbot


### Run MATLAB code to generate quintic polynomials for waypoints along path and saving polynomial coefficients:
    matlab TrajectoryGenerator.m
This code includes defining the start point, end points, obstacles location and the number of via points required along the path. Once those points are defined, by running the code, a collision-free path will be automatically generated and plotted in addition to the selected via points. Then the corresponding trajectories (Poisitions, Velocities and accelerations) will be generated automatically and plotted in addition to storing the polynomials cofficients for both x and y coordinates in a1 and a2 matrices. These cofficients will be fed to the dynamic model directly.



### Run Python implementation of dynamic model and PD controller:
    python src/mecanum_wheel_mobile_robot_controller_coef.py
This will load the coefficients generated by the quintic polynomial interpolation to create the reference trajectory. The Python will use constant initial state, gain matrices, and time span for the controller to follow the reference trajectories under various payloads. Code will save controller trajectories when payload equals 0 and 100 kg and save it to /simulations for the next step. Will plot and save all graphs for each payload experiment in directory called: "KUKA_Trajectories_From_Coefficients".


### (Optional):
    python src/mecanum_wheel_mobile_robot_controller.py
This will use controller to follow pre-defined simple trajectories x(t) = t^3 and y(t) = sin(t). Will plot and save all graphs for each payload experiment in directory called: "KUKA_Trajectories".


### Run animation in matplotlib to visualize simulated KUKA YouBot following trajectory:
    python simulations/sim1_with_control.py
This will load the trajectories saved from the previous step and plot the reference and controller-generated trajectories in a 3D plot. The simulated KUKA YouBot will follow the controller-generated trajectory in an animation.
Uncomment line 23 to show animation when payload = 0:

    new_path = np.vstack((x_pos, y_pos))
    
Uncomment line 26 to show animation when payload = 100:

    new_path = np.vstack((x_pos_100, y_pos_100))


### TODO: Run the following to visualize velocity fitting procedure under velocity constraints produced by Centrifugal forces along waypoints of path:




Installation for Gazebo Utilization
-----------------------------------

### System requirements: 
* Linux 16.04 LTS
* ROS Kinetic
* Gazebo 7


## Installation instructions


Go to your catkin workspace, for example:

    cd ~/catkin_ws
    
Clone the kinetic-devel branch of the repository we forked from the Team Luhbots:

    git clone -b kinetic-devel https://github.com/wpi-youbot/luh_youbot_os


Clone this repository to your catkin workspace:

    git clone https://github.com/wpi-youbot/wpi-youbot

Install the following dependencies:

    sudo apt-get install libnlopt-dev   
    sudo apt-get install gksu

#### Please report any additional dependencies missing.


Build your workspace

    catkin_make

Launch the YouBot base simulation program from the LUH package:  

    roslaunch luh_youbot_gazebo base_only.launch

Launch a sample program from our package:  

    roslaunch wpi-youbot launch.launch
        
